name: No Circula Bot — Daily

on:
  # 6:00 AM hora CDMX (UTC-6, sin horario de verano desde 2023)
  # 6:00 CDMX = 12:00 UTC
  schedule:
    - cron: "36 5 * * *"

  # Permite ejecución manual desde la pestaña Actions
  workflow_dispatch:

jobs:
  notify:
    name: Verificar y notificar
    runs-on: ubuntu-latest

    env:
      TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
      TELEGRAM_CHAT_ID:   ${{ secrets.TELEGRAM_CHAT_ID }}
      PLACA_ULTIMO_DIGITO: ${{ secrets.PLACA_ULTIMO_DIGITO }}
      HOLOGRAMA:           ${{ secrets.HOLOGRAMA }}
      NOTIFICAR_SOLO_SI_NO_CIRCULA: ${{ secrets.NOTIFICAR_SOLO_SI_NO_CIRCULA }}
      LOG_LEVEL:           INFO

    steps:
      - name: Checkout del repositorio
        uses: actions/checkout@v4

      - name: Configurar Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
          cache: pip

      - name: Instalar dependencias
        run: pip install -r requirements.txt

      - name: Ejecutar bot
        run: python main.py
